<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Birthday Journey</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      background: #000;
      color: white;
      height: 100%;
      width: 100%;
    }

    /* Loading Screen */
    #loadingScreen {
      position: absolute;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 10;
      font-size: 2rem;
    }

    /* Confetti */
    #confetti-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }

    /* Cards */
    #cardContainer {
      position: absolute;
      top: 20%;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      padding: 20px;
      border-radius: 15px;
      text-align: center;
      max-width: 300px;
      z-index: 5;
    }

    /* Subtitle */
    #subtitle {
      position: absolute;
      bottom: 70px;
      width: 100%;
      text-align: center;
      font-size: 1.5rem;
      z-index: 5;
    }

    /* Buttons */
    .nav-buttons {
      position: absolute;
      bottom: 120px;
      width: 100%;
      text-align: center;
      z-index: 6;
    }

    .nav-buttons button {
      margin: 0 10px;
      padding: 15px 25px;
      font-size: 1.3rem;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      cursor: pointer;
      border-radius: 10px;
      border: none;
      background: #ff69b4;
      color: white;
      opacity: 1;
      transition: opacity 0.3s;
    }

    .nav-buttons button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* Airplane */
    #plane {
      position: absolute;
      font-size: 3rem;
      z-index: 4;
      transition: transform 1s ease;
    }
  </style>
</head>
<body>
  <canvas id="confetti-canvas"></canvas>

  <div id="loadingScreen">Preparing your surprise...</div>

  <div id="cardContainer" style="display:none;">
    <h2 id="cardTitle">Welcome</h2>
    <img id="cardImage" src="" alt="" style="max-width:100%; display:none;" />
    <p id="cardText"></p>
  </div>

  <div class="nav-buttons" style="display:none;">
    <button id="prevBtn">Previous</button>
    <button id="nextBtn">Next</button>
  </div>

  <div id="subtitle">From country1 to country2, to country3... and beyond ‚ù§Ô∏è</div>
  <div id="plane">‚úàÔ∏è</div>

  <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three-globe"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
  <script>
    const loadingScreen = document.getElementById("loadingScreen");
    const cardContainer = document.getElementById("cardContainer");
    const cardTitle = document.getElementById("cardTitle");
    const cardText = document.getElementById("cardText");
    const cardImage = document.getElementById("cardImage");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const navButtons = document.querySelector(".nav-buttons");
    const plane = document.getElementById("plane");
    const confettiCanvas = document.getElementById("confetti-canvas");

    // Initialize confetti
    const confettiSettings = { particleCount: 200, spread: 120, origin: { y: 0.6 } };
    setInterval(() => confetti(confettiSettings), 1500);

    // Scene setup
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 0.1, 2000);
    camera.position.z = 400;

    const globe = new ThreeGlobe()
      .globeImageUrl('//unpkg.com/three-globe/example/img/earth-dark.jpg')
      .pointsData([])
      .pointAltitude(0.01)
      .pointColor(() => '#ff69b4');
    scene.add(globe);

    const light = new THREE.AmbientLight(0xffffff, 1);
    scene.add(light);

    const countryCoords = {
      Turkey: [35, 39],
      Azerbaijan: [47.5, 40.4],
      Greece: [23.7, 38],
      Sweden: [18.6, 60.1],
      Iceland: [-19, 64.9]
    };

    const countryOrder = ["Turkey", "Azerbaijan", "Greece", "Sweden", "Iceland"];
    let currentIndex = -1;
    let currentPos = { x: -100, y: window.innerHeight / 2 }; // plane start pos
    plane.style.transform = `translate(${currentPos.x}px, ${currentPos.y}px)`;

    function movePlaneTo(lat, lng, callback) {
      const screenX = window.innerWidth / 2 + lng * 5;
      const screenY = window.innerHeight / 2 - lat * 5;

      plane.animate([
        { transform: `translate(${currentPos.x}px, ${currentPos.y}px) rotate(0deg)` },
        { transform: `translate(${(currentPos.x + screenX) / 2}px, ${(currentPos.y + screenY) / 2 - 50}px) rotate(-20deg)` },
        { transform: `translate(${screenX}px, ${screenY}px) rotate(15deg)` }
      ], {
        duration: 2000,
        easing: 'ease-in-out'
      }).onfinish = () => {
        plane.style.transform = `translate(${screenX}px, ${screenY}px) rotate(0deg)`;
        currentPos = { x: screenX, y: screenY };
        callback && callback();
      };
    }

    function updateCard() {
      const country = countryOrder[currentIndex];
      cardTitle.innerText = country;
      cardText.innerText = "Exploring " + country + "!";
      cardImage.style.display = 'none';
      prevBtn.disabled = (currentIndex === 0);
      nextBtn.textContent = (currentIndex === countryOrder.length - 1) ? "End" : "Next";
    }

    function goToCountry(index) {
      navButtons.querySelectorAll("button").forEach(btn => btn.disabled = true);
      const country = countryOrder[index];
      const [lng, lat] = countryCoords[country];
      movePlaneTo(lat, lng, () => {
        currentIndex = index;
        updateCard();
        navButtons.querySelectorAll("button").forEach(btn => btn.disabled = false);
      });
    }

    nextBtn.addEventListener("click", () => {
      if (currentIndex < countryOrder.length - 1) goToCountry(currentIndex + 1);
      else cardContainer.innerHTML = "<h2>Happy Birthday! üéâüéÇ</h2>";
    });

    prevBtn.addEventListener("click", () => {
      if (currentIndex > 0) goToCountry(currentIndex - 1);
    });

    setTimeout(() => {
      loadingScreen.style.display = 'none';
      cardContainer.style.display = 'block';
      navButtons.style.display = 'block';
      cardTitle.innerText = "Welcome!";
      cardText.innerText = "Ready for a trip around the world?";
      nextBtn.textContent = "Start";
      nextBtn.onclick = () => {
        goToCountry(0);
        nextBtn.onclick = () => {
          if (currentIndex < countryOrder.length - 1) goToCountry(currentIndex + 1);
          else cardContainer.innerHTML = "<h2>Happy Birthday! üéâüéÇ</h2>";
        };
      };
    }, 2000);

    function animate() {
      renderer.render(scene, camera);
      requestAnimationFrame(animate);
    }
    animate();
  </script>
</body>
</html>
