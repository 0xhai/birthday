<!-- Only showing the fixed parts -->

<style>
  /* âœ… Cake emoji now placed above the bar */
  .progress-wrapper {
    position: relative;
    display: inline-block;
  }
  #cakeEmoji {
    position: absolute;
    top: -35px;
    font-size: 26px;
    left: 0;
    transition: left 0.1s linear;
  }
</style>

<div class="progress-wrapper">
  <div id="cakeEmoji">ðŸŽ‚</div>
  <div class="progress-bar">
    <div class="progress-fill" id="progressFill"></div>
    <div id="progressText">0%</div>
  </div>
</div>

<script>
  // âœ… Correct emoji tracking above bar
  const barWidth = 300;
  cakeEmoji.style.left = '0px';
  const progressInterval = setInterval(() => {
    if(progress < 100) {
      progress++;
      fill.style.width = progress + '%';
      progressText.textContent = progress + '%';
      cakeEmoji.style.left = (progress / 100 * barWidth - 12) + 'px';
    } else {
      clearInterval(progressInterval);
      continueText.style.display = 'block';
    }
  }, 50);

  // âœ… Globe navigation fix
  let currentLat = 20, currentLng = 0;

  async function showStop(index) {
    animating = true;
    infoCard.style.display = 'none';

    const { lat, lng } = tourStops[index];
    currentStop = index;

    // Animate smoothly from last known view to target
    await animateTo(lat, lng, 2.0, 1200);
    await animateTo(lat, lng, 1.0, 1200);
    await animateTo(lat, lng, 0.5, 1500);

    currentLat = lat;
    currentLng = lng;

    infoImage.src = tourStops[index].img;
    typeWriterEffect(tourStops[index].message, infoText);
    infoCard.style.display = 'block';
    animating = false;
    updateButtons();
  }
</script>
